{% extends "base.html" %} {% block content %}
<h2 style="color: #8b4789">ðŸŒ¼ Our Beautiful Collection</h2>
<div class="grid">
  {% for p in products %}
  <div class="card">
    {% if p.image_url %}
    <div
      style="
        width: 100%;
        height: 160px;
        background: #f9f4fa;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1rem;
        overflow: hidden;
      "
    >
      <img
        src="{{ p.image_url }}"
        alt="{{ p.name }}"
        style="width: 100%; height: 100%; object-fit: contain"
      />
    </div>
    {% endif %}
    <div class="card-header">
      <h3>{{ p.name }}</h3>
      <span class="price">${{ "%.2f"|format(p.price) }}</span>
    </div>
    <p>{{ p.description }}</p>
    {% if p.category %}<span class="badge">{{ p.category }}</span>{% endif %}
    <button
      class="btn btn-small"
      onclick="addToCart({{ p.id }}, '{{ p.name }}', {{ p.price }})"
      style="width: 100%; margin-top: 1rem"
    >
      Add to Cart
    </button>
  </div>
  {% endfor %}
</div>

<script>
  function addToCart(productId, productName, price) {
    fetch("/api/cart/add", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ product_id: productId, quantity: 1 }),
    })
      .then((r) => r.json())
      .then((data) => {
        alert(productName + " added to cart!");
        document.getElementById("cart-count").textContent = data.items_count;
      });
  }
</script>
{% endblock %}
